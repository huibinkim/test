!function(){var __ba_script__={event:{ua:navigator.userAgent,host:window.location.host,refer:document.referrer,initial_refer:document.referrer,ct:(new Date).toISOString(),url:null,pathname:null,sid:window.__baclient__.sid,code_v:window.__baclient__._code_v||1,ssid:null,seq:0,parent_seq:0,title:null,time:null,exist:!1,reload_count:0,rollback:!1,prev_click:!1},_event:{reload:!1,parent_host:window.__baclient__.rootDomain,last_url:null,event_fired:!1,unload_seq:0,unload_parent_seq:0,survey:window.__baclient__.survey||null,survey_load:!1},initTime:new Date,rand:-1,samplingRate:window.__baclient__.samplingRate||100,init:function(){if(window.location.href.indexOf("beusable_viewer")>0||window.location.host.indexOf("translate.goog")>0||window.location.host.indexOf("googleusercontent.com")>0)return!1;if(window.location.host.indexOf(this._event.parent_host)<0)return!1;var expire=new Date;if(expire.setMinutes(expire.getMinutes()+30),this._cookie.hasItem("_ba_rand")?this.rand=parseInt(__ba_script__._cookie.getItem("_ba_rand")):this.rand=Math.floor(100*Math.random()).toString(),this._cookie.setItem("_ba_rand",this.rand,expire,"/",this._event.parent_host,!1),this.rand>this.samplingRate)return this.reset_cookie(),!1;var pushState=history.pushState,replaceState=history.replaceState;history.pushState=function(){pushState.apply(history,arguments),__ba_script__.send_event(!0)},history.replaceState=function(){replaceState.apply(history,arguments),__ba_script__.send_event(!0)},window.addEventListener("popstate",function(){window.dispatchEvent(new Event("locationchange"))}),window.addEventListener("locationchange",function(){__ba_script__.send_event(!0)}),window.__ba_script__=__ba_script__,__ba_script__.send_event(!1);try{var click_event=function(event){var eventType=event.type;if("click"===eventType||"touchend"==eventType){var element=event.target||event.srcElement;if("HTML"!==element.tagName){var expire=new Date;expire.setMinutes(expire.getMinutes()+30),__ba_script__._cookie.setItem("_ba_click",!0,expire,"/",null,!1),__ba_script__._event.event_fired=!0}}else"scroll"!==eventType&&"mousemove"!==eventType||(__ba_script__._event.event_fired=!0)},oldIE=!window.addEventListener,elDoc=null;oldIE?(elDoc=!!document.attachEvent,elDoc?document.attachEvent("onclick",click_event):document.body.attachEvent("onclick",click_event)):(elDoc=!!document.addEventListener,elDoc?("ontouchstart"in window?document.addEventListener("touchend",click_event,!0):(document.addEventListener("click",click_event,!0),document.addEventListener("mousemove",click_event,!0)),document.addEventListener("scroll",click_event,!0)):("ontouchstart"in window?window.addEventListener("touchend",click_event,!0):(window.addEventListener("click",click_event,!0),window.addEventListener("mousemove",click_event,!0)),window.addEventListener("scroll",click_event,!0)))}catch(e){}setInterval(function(){__ba_script__._event.event_fired&&(__ba_script__._cookie.hasItem("_ba_ssid")&&__ba_script__._cookie.getItem("_ba_ssid")&&__ba_script__._cookie.hasItem("_ba_page_seq")&&(__ba_script__.event.seq=null===__ba_script__._cookie.getItem("_ba_page_seq")?0:parseInt(__ba_script__._cookie.getItem("_ba_page_seq")),__ba_script__.event.parent_seq=null===__ba_script__._cookie.getItem("_ba_parent_seq")?0:parseInt(__ba_script__._cookie.getItem("_ba_parent_seq")),__ba_script__.refresh_cookie()),__ba_script__._event.event_fired=!1)},1e4)},init_survey:function(){this._event.survey&&(this._event.survey_load?__ba_survey_script__.check_target():(this._event.survey_load=!0,__baclient__.load(this._event.survey.script_url)))},send_event:function(spa,idx){if(void 0===idx)idx=0;else if(idx>1)return!1;var expire=new Date,expire_yr=new Date;if(expire.setMinutes(expire.getMinutes()+30),expire_yr.setUTCFullYear(expire.getUTCFullYear()+1),this._cookie.hasItem("_ba_exist")&&(this.event.exist=!0),this._cookie.hasItem("_ba_click")&&(this.event.prev_click=!0),this._event.last_url=this._cookie.getItem("_ba_last_url"),this._cookie.hasItem("_ba_last_2nd_url")){var last2Url=this._cookie.getItem("_ba_last_2nd_url");last2Url!==window.location.href||this._event.last_url===window.location.href||this.event.prev_click||(this.event.rollback=!0)}if(this._event.reload||(this._event.reload=window.location.href&&window.location.href===this._event.last_url),this._event.last_url&&!this._event.reload&&this._cookie.setItem("_ba_last_2nd_url",this._event.last_url,expire,"/",this._event.parent_host,!1),this._cookie.setItem("_ba_exist",!0,expire_yr,"/",this._event.parent_host,!1),this._cookie.hasItem("_ba_ssid")&&this._cookie.getItem("_ba_ssid")&&this._cookie.hasItem("_ba_page_seq")){if(this.event.initial_refer=this._cookie.getItem("_ba_initial_refer"),this.event.initial_refer=this.event.initial_refer&&"null"!==this.event.initial_refer?this.event.initial_refer:"",!(this._event.reload||this.event.initial_refer===document.referrer||document.referrer&&""!==document.referrer&&document.referrer.indexOf(this._event.parent_host)!==-1))return this.reset_cookie(),this.send_event(spa,++idx),!1;this.event.ssid=this._cookie.getItem("_ba_ssid"),this.event.seq=null===this._cookie.getItem("_ba_page_seq")?0:parseInt(this._cookie.getItem("_ba_page_seq")),this.event.parent_seq=null===this._cookie.getItem("_ba_parent_seq")?0:parseInt(this._cookie.getItem("_ba_parent_seq")),this.event.rollback?(null===this.event.seq?this.event.seq=0:this.event.seq>0&&this.event.seq--,this.event.parent_seq>0&&this.event.parent_seq--):this._event.reload||(null===this.event.seq?this.event.seq=0:this.event.seq++,this.event.parent_seq++),this.event.ct=this._cookie.getItem("_ba_page_ct"),this.event.parent_seq<this.event.seq&&(this.event.seq=0)}else this.reset_cookie(),this.event.ssid=this._uuid_v4(),this.event.seq=0,this.event.parent_seq=0,this.event.ct=(new Date).toISOString(),this._cookie.setItem("_ba_initial_refer",this.event.initial_refer,expire,"/",this._event.parent_host,!1);this._event.reload?(this._cookie.hasItem("_ba_reload_count")&&(this.event.reload_count=parseInt(this._cookie.getItem("_ba_reload_count"))),this.event.reload_count++,this._cookie.setItem("_ba_reload_count",this.event.reload_count,expire,"/",null,!1)):(this._cookie.removeItem("_ba_reload_count","/",null),this.event.reload_count=0),this._event.unload_seq=this.event.seq,this._event.unload_parent_seq=this.event.parent_seq,this.event.url=window.location.href,this.event.pathname=window.location.pathname,this.event.title=document.title,this.event.refer=this._event.last_url||document.referrer,this.event.time=(new Date).toISOString();var xhr=new XMLHttpRequest;xhr.open("POST",this._ba_host+"/script/ba"),xhr.setRequestHeader("Content-Type","application/json"),xhr.send(JSON.stringify(this.event)),this.refresh_cookie(),this._cookie.removeItem("_ba_click","/",null),this._event.reload=!1,this.event.rollback=!1,this.event.prev_click=!1,this._event.last_url=this.event.url,this.init_survey()},refresh_cookie:function(){var expire=new Date;expire.setMinutes(expire.getMinutes()+30),this._cookie.setItem("_ba_ssid",this.event.ssid,expire,"/",this._event.parent_host,!1),this._cookie.setItem("_ba_page_seq",this.event.seq,expire,"/",null,!1),this._cookie.setItem("_ba_parent_seq",this.event.parent_seq,expire,"/",this._event.parent_host,!1),this._cookie.setItem("_ba_page_ct",this.event.ct,expire,"/",this._event.parent_host,!1),this._cookie.setItem("_ba_last_url",window.location.href,expire,"/",this._event.parent_host,!1),this._cookie.hasItem("_ba_last_2nd_url")&&this._cookie.setItem("_ba_last_2nd_url",this._cookie.getItem("_ba_last_2nd_url"),expire,"/",this._event.parent_host,!1),this._cookie.hasItem("_ba_reload_count")&&this._cookie.setItem("_ba_reload_count",this.event.reload_count,expire,"/",null,!1),this._cookie.hasItem("_ba_initial_refer")&&this._cookie.setItem("_ba_initial_refer",this.event.initial_refer,expire,"/",null,!1)},reset_cookie:function(){this.event.ssid=null,this.event.seq=0,this.event.parent_seq=0,this.event.reload_count=0,this.event.initial_refer=document.referrer,this._event.reload=!1,this.event.rollback=!1,this.event.prev_click=!1,this._event.last_url=null,this._cookie.removeItem("_ba_ssid","/",this._event.parent_host),this._cookie.removeItem("_ba_page_seq","/",null),this._cookie.removeItem("_ba_parent_seq","/",this._event.parent_host),this._cookie.removeItem("_ba_page_ct","/",this._event.parent_host),this._cookie.removeItem("_ba_last_url","/",this._event.parent_host),this._cookie.removeItem("_ba_last_2nd_url","/",this._event.parent_host),this._cookie.removeItem("_ba_reload_count","/",null),this._cookie.removeItem("_ba_initial_refer","/",null)},_ba_host:"//ba.beusable.net",_cookie:{getItem:function(sKey){var value=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null;return"null"===value&&(value=null),value},setItem:function(sKey,sValue,vEnd,sPath,sDomain,bSecure){if(!sKey||/^(?:expires|max\-age|path|domain|secure)$/i.test(sKey))return!1;var sExpires="";if(vEnd)switch(vEnd.constructor){case Number:sExpires=vEnd===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+vEnd;break;case String:sExpires="; expires="+vEnd;break;case Date:sExpires="; expires="+vEnd.toUTCString()}return document.cookie=encodeURIComponent(sKey)+"="+encodeURIComponent(sValue)+sExpires+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"")+(bSecure?"; secure":""),!0},removeItem:function(sKey,sPath,sDomain){return!(!sKey||!this.hasItem(sKey))&&(document.cookie=encodeURIComponent(sKey)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:""),!0)},hasItem:function(sKey){var test=new RegExp("(?:^|;\\s*)"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie);if(test){var value=this.getItem(sKey);if("null"===value)return!1}return test},keys:function(){for(var aKeys=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),nIdx=0;nIdx<aKeys.length;nIdx++)aKeys[nIdx]=decodeURIComponent(aKeys[nIdx]);return aKeys}},_uuid_v4:function(){for(var text="",possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<8;i++)text+=possible.charAt(Math.floor(Math.random()*possible.length));return text}};window.__ba_script__||__ba_script__.init()}();